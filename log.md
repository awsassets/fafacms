## Log Update

### 201910

版本：`2.1.4`

1. Fix：违禁的内容可以移到垃圾箱，当恢复时仍然是违禁。
2. Add：新增取消匿名评论接口。
3. Add：用户字段新增`已发布正常显示的内容数`（内容节点隐藏的也会统计）。
4. Add：用户字段新增`内容历史点赞数`和`评论历史点赞数`（被取消点赞时会减少，其他情况诸如评论或内容被删除时不会变化）。
5. Add：内容节点新增`已发布正常显示的内容数`。

版本：`2.1.3`

1. Fix：修复信息接口的缺陷
2. Add：第二期文档完成

版本：`2.1.2`

1. Add：用户间私信。
2. Add：发送方可以删除发出和接收的私信。
3. Tip：任何人都可以互发私信，并且私信不可以撤回，存在作恶者滥发私信行为，目前不处理，等后期发现时功能再优化。
4. Add：支持传入flag `-can_scale` 和 `-scale_width` 配置是否上传自动图片裁剪和裁剪宽度。

版本：`2.1.1`

1. Add：官网列出评论增加筛选，允许筛选第一级评论。
2. Add：管理员通知站内信相关操作。

### 201909

目前已经支持站内信的版本为标签tag:`2.1.0`。

1. 支持传入flag `-time_zone` 参数设置时区，默认为东八区北京时间。
2. 修复某些空指针异常，补充节点内容相关API文档，前端优化。
3. 自动化部署[脚本](install/README.md)数据库升级：`mysql:5.7.27`，`redis:5.0.5`，管理工具集成：`phpmyadmin:edge-4.9`。
4. 强制要求节点和内容SEO必须存在，方便前端开发。
5. 修复内容API若干缺陷，细化内容筛选条件。增加删除历史内容API，细化历史内容筛选条件。
6. 内容字段 `edit_time`修改为`update_time`，表示草稿最新更新时间，增加`first_publish_time`表示第一次发布时间，并调整相应逻辑。
7. 基本文档全部完成。
8. Add：内容可以被点赞和举报，服务端可以设置当举报超过某值时内容会被违禁，管理员可以解除违禁，解除违禁时系统自动删除所有举报。举报和点赞只能是登录用户，每个人对每一个内容只有一次点赞和举报机会，可以取消点赞和举报。
9. Add：对内容进行评论，对评论进行评论，对评论进行点赞和举报，服务端可以设置当举报超过某值时评论被违禁，管理员可以设置违禁和解除违禁。
10. Fix：被违禁的内容在前端也会被列出，但进入内容详情页时会报内容违禁提示。
11. Add：用户昵称需要唯一，且一个月内只能修改两次昵称。
12. Fix：前端获取节点和获取内容，当ID为空时SEO和用户信息必须存在，才能定位到节点和内容。查找某一个节点时，该节点的隐藏儿子节点不会再被列出。
13. Add：只有VIP用户可以创建节点和发表内容，其他用户只能评论。类似于付费才能成为作者，否则只能评论。
14. Add：增加flag `-single_login` 设置是否单点登录，`-session_expire_time` 设置登录`token`有效期。
15. Add：用户关注和被关注功能，用户可互相关注。
16. Add：历史内容支持创建时间筛选。
17. Fix：某些事务没有`commit`修复。
18. Fix：安装脚本修改`my.cnf`644权限，解决`mysql`配置不生效问题。
19. Add：增加用户字段`short_describe`表示一句话描述。
20. Add：部分评论接口增加字段`is_yourself`，表示评论是自己的。
21. Add：互动消息站内信，如评论被点赞，内容被点赞，内容被评论，评论被评论。系统通知站内信，内容被违禁，评论被违禁等。

### 201908

1. 可选择不将内容记录进历史。
2. 改为单点登录，任何用户登录会挤掉其他端的用户。
3. 用户访问临时令牌加长到7天有效。
4. 数据库切为utf8mb4完善文本保存。
5. 自动创建数据库，不必再手动创建。
6. 启动时打印版本号。
7. 完善邮件发送逻辑，验证码有效期为5分钟，激活码重置不需要之前的激活码。
8. 完善用户注册，忘记密码，用户，用户组操作等前端API文档。
9. 完成用户注册，登录，忘记密码，注销前端UI。

### 201904-06

1. 支持本地文件模式，也支持阿里云对象存储文件上下载。
2. 注册用户，用户忘记密码发邮件功能。
3. 取消了cookie功能，让大前端自己实现，只实现自定义的用户session redis功能，改为token API模式，需授权API均检测该token，token和用户信息均保存在redis，缓存击穿时再从mysql加载。
4. 实现自动创建数据库，数据库表，填充管理员账户。
5. 自动将admin URL置于变量内存中，避免管理员API权限过滤时，频繁查找数据库。
6. 文章节点，文章等有菜单排序的功能，均支持强大拖拽排序。
7. 实现自动docker hub打包镜像发布，提供从数据库到后端的一键部署脚本。

### 201904

1. 调研。设计产品。
2. 资源准备：阿里云对象存储测试，邮件测试，测试服务器准备。
3. 代码框架预设，抽离整理，实现基本功能。